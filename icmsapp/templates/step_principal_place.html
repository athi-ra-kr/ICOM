{% extends "base_trn.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

<style>
    * { box-sizing: border-box; font-family: "Segoe UI", Tahoma, Arial, sans-serif; }

    .page-wrapper {
      max-width: 100%;
      margin: 0;
      background: #fff;
      padding: 10px 0 0 0;
    }

    .top-row { display: flex; justify-content: space-between; align-items: flex-start; }
    h1.page-title { font-size: 22px; margin: 0 0 5px; color: #333; }

    .mandatory-note { font-size: 12px; color: #666; margin-top: 4px; }
    .mandatory-note::before { content: "‚óè "; color: #e11; }

    hr.page-divider { border: none; border-top: 1px solid #d0d4db; margin: 12px 0 10px; }

    .yellow-note { margin-top: 4px; padding: 12px 16px; background: #fff7df; border: 1px solid #f2e2b3; font-size: 13px; line-height: 1.5; font-style: italic; color: #555; }

    .section-title { font-size: 18px; font-weight: 600; margin: 18px 0 0; display: flex; align-items: center; color: #003366; }
    .section-title .icon { margin-right: 6px; font-size: 16px; }

    hr.section-divider { border: none; border-top: 1px solid #d0d4db; margin: 4px 0 0; }

    .section-box { background: #f7f7f7; border-top: 1px solid #e0e0e0; padding: 16px 16px 14px; margin-top: 5px; }

    .form-row { display: flex; gap: 20px; margin-bottom: 12px; }
    .form-group { flex: 1; display: flex; flex-direction: column; font-size: 13px; }
    .form-group.small { max-width: 260px; }

    label { margin-bottom: 3px; color: #333; }
    .required::after { content: " *"; color: #e11; }

    input[type="text"], input[type="email"], input[type="tel"], select {
      border: 1px solid #c0c4cc; padding: 6px 8px; border-radius: 0; font-size: 13px; min-height: 32px; width: 100%;
    }

    .info-text { font-size: 12px; color: #555; margin-top: 4px; }

    /* MAP */
    #map { width: 100%; height: 260px; border: 1px solid #c0c4cc; margin-top: 10px; }

    .btn { padding: 8px 18px; border-radius: 2px; border: none; cursor: pointer; font-size: 13px; text-decoration: none; display: inline-block; }
    .btn-reset { background: #235f9f; color: #fff; padding: 8px 26px; }
    .reset-wrapper { text-align: center; margin: 16px 0 4px; }

    .btn-file { padding: 4px 12px; font-size: 12px; border-radius: 3px; border: 1px solid #ccc; background: #f5f5f5; cursor: pointer; }
    .btn-primary { background: #5b76a8; color: #fff; }
    .btn-secondary { background: #e4e7ed; color: #333; border: 1px solid #c0c4cc; }
    .btn-blue { background: #5b76a8; color: #fff; }
    .btn-green { background: #235f9f; color: #fff; }

    .jurisdiction-row { margin-top: 10px; }
    .inline-note { font-size: 12px; color: #444; margin-bottom: 6px; }

    .upload-flex { display: flex; gap: 40px; margin-top: 10px; }
    .upload-half { flex: 1; }

    .business-activity-box { margin-top: 14px; background: #f7f7f7; border-top: 1px solid #e0e0e0; padding: 16px 16px 10px; }
    .three-col { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px 30px; font-size: 14px; }
    .activity-item { display: flex; align-items: center; gap: 6px; padding: 2px 0; }

    .toggle-wrapper { display: flex; align-items: center; gap: 10px; margin-top: 10px; }
    .toggle { width: 56px; height: 28px; background: #e0e0e0; border-radius: 14px; position: relative; cursor: pointer; }
    .toggle::before { content: ""; position: absolute; top: 3px; left: 3px; width: 22px; height: 22px; border-radius: 50%; background: #fff; box-shadow: 0 0 2px rgba(0,0,0,0.3); transition: all 0.2s ease; }
    .toggle.on { background: #2cab3d; }
    .toggle.on::before { left: 31px; }

    .btn-bar { margin-top: 28px; display: flex; justify-content: flex-end; gap: 10px; }

    @media (max-width: 1000px) {
      .form-row { flex-direction: column; }
      .three-col { grid-template-columns: 1fr 1fr; }
      .upload-flex { flex-direction: column; }
    }
    @media (max-width: 700px) {
      .three-col { grid-template-columns: 1fr; }
    }
</style>

<form method="POST">
{% csrf_token %}
<div class="page-wrapper">

  <div class="top-row">
    <h1 class="page-title">Details of Principal Place of Business</h1>
    <div class="mandatory-note">indicates mandatory fields</div>
  </div>

  <hr class="page-divider">

  <div class="yellow-note">
    i. Please be aware that the GST system incorporates mandatory address validations...<br>
    ii. Users must ensure that addresses entered align with these validations...
  </div>

  <div class="section-title">
    <span class="icon">‚úâ</span> Address
  </div>
  <hr class="section-divider">

  <div class="section-box">
    <div id="map"></div>

    <div style="margin-top:16px;">
      <div class="form-row">
        <div class="form-group">
          <label class="required">Pin Code</label>
          <input type="text" name="pincode" placeholder="Enter Pin Code" value="{{ pp.pincode }}">
        </div>
        <div class="form-group">
          <label class="required">State</label>
          <input type="text" name="state" placeholder="Enter State Name" value="{{ pp.state }}">
        </div>
        <div class="form-group">
          <label class="required">District</label>
          <input type="text" name="district" placeholder="Enter District Name" value="{{ pp.district }}">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="required">City / Town / Village</label>
          <input type="text" name="city" placeholder="Enter City / Town / Village" value="{{ pp.city }}">
        </div>
        <div class="form-group">
          <label>Locality/Sub Locality</label>
          <input type="text" name="locality" placeholder="Enter Locality/Sub Locality">
        </div>
        <div class="form-group">
          <label class="required">Road / Street.</label>
          <input type="text" name="street" placeholder="Enter Road / Street / Lane">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Name of the Premises / Building</label>
          <input type="text" name="premises" placeholder="Enter Premises / Building">
        </div>
        <div class="form-group">
          <label class="required">Building No. / Flat No.</label>
          <input type="text" name="building" placeholder="Enter Building No. / Flat No. / Door No.">
        </div>
        <div class="form-group">
          <label>Floor Number</label>
          <input type="text" name="floor_no" placeholder="Enter Floor Number">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Nearby Landmark</label>
          <input type="text" placeholder="Enter Nearby Landmark">
        </div>
        <div class="form-group">
          <label>Latitude</label>
          <input type="text" name="latitude" placeholder="Enter Latitude" id="latField">
        </div>
        <div class="form-group">
          <label>Longitude</label>
          <input type="text" name="longitude" placeholder="Enter Longitude" id="lngField">
        </div>
      </div>

      <div class="reset-wrapper">
        <button type="button" class="btn btn-reset">‚ü≥ RESET ADDRESS</button>
      </div>
    </div>
  </div>

  <div class="section-box" style="margin-top:16px;">
    <div class="jurisdiction-row">
      <div class="form-row">
        <div class="form-group">
          <label>State Jurisdiction</label>
          <input type="text" placeholder="Circle">
        </div>
        <div class="form-group">
          <label class="required">Sector / Circle / Ward / Charge / Unit</label>
          <input type="text" placeholder="Sector / Circle / Ward / Charge / Unit">
        </div>
      </div>
    </div>

    <div class="jurisdiction-row" style="margin-top:12px;">
      <div class="inline-note">Center Jurisdiction (‚Ñπ Refer the üîó link for center Jurisdiction)</div>
      <div class="form-row">
        <div class="form-group"><label class="required">Commissionerate</label><input type="text"></div>
        <div class="form-group"><label class="required">Division</label><input type="text"></div>
        <div class="form-group"><label class="required">Range</label><input type="text"></div>
      </div>
    </div>
  </div>

  <div class="section-title">
    <span class="icon">üßæ</span> Contact Information
  </div>
  <hr class="section-divider">

  <div class="section-box">
    <div class="form-row">
      <div class="form-group">
        <label class="required">Office Email Address</label>
        <input type="email" name="office_email">
      </div>
      <div class="form-group">
        <label>Office Telephone Number (with STD Code)</label>
        <div class="form-row">
          <div class="form-group small"><input type="text" placeholder="STD"></div>
          <div class="form-group"><input type="text" placeholder="Enter Telephone Number"></div>
        </div>
      </div>
      <div class="form-group">
        <label class="required">Mobile Number</label>
        <div class="form-row">
          <div class="form-group small"><input type="text" value="+91"></div>
          <div class="form-group"><input type="tel" name="office_mobile"></div>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group small">
        <label>Office Fax Number (with STD Code)</label>
        <input type="text" placeholder="STD">
      </div>
      <div class="form-group">
        <label>&nbsp;</label>
        <input type="text" placeholder="Enter Telephone Number">
      </div>
    </div>
  </div>

  <div class="section-box" style="margin-top:16px;">
    <div class="info-text" style="margin-bottom:10px;">
      ‚ìò If the Principal place of business is located in sez...
    </div>

    <div class="upload-flex">
      <div class="upload-half">
        <div class="section-title" style="font-size:16px;margin:0 0 4px;">
          <span class="icon">üè¢</span> Nature of possession of premises
        </div>
        <div class="form-group" style="margin-top:8px;">
          <label class="required">Please Select</label>
          <select name="nature_possession">
            <option>Select</option>
            <option>Owned</option>
            <option>Rented</option>
          </select>
        </div>
      </div>

      <div class="upload-half">
        <div class="section-title" style="font-size:16px;margin:0 0 4px;">
          <span class="icon">üì§</span> Document Upload
        </div>
        <div class="form-group" style="margin-top:8px;">
          <label class="required">Proof of Principal Place of Business</label>
          <select>
            <option>Select</option>
          </select>
        </div>
        <div class="info-text">‚ìò File with PDF or JPEG format is only allowed</div>
        <div class="info-text">‚ìò Maximum file size for upload 1 MB</div>
        <div style="margin-top:8px;">
          <button type="button" class="btn-file">Choose File</button>
          <span style="font-size:12px;">No file chosen</span>
        </div>
      </div>
    </div>
  </div>

  <div class="section-title" style="margin-top:18px;">
    <span class="icon">üöö</span> Nature of Business Activity being carried out at above mentioned premises
  </div>
  <hr class="section-divider">

  <div class="business-activity-box">
    <div class="three-col">
      <div>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Bonded Warehouse"> <span>Bonded Warehouse</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Factory / Manufacturing"> <span>Factory / Manufacturing</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Leasing Business"> <span>Leasing Business</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Retail Business"> <span>Retail Business</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Works Contract"> <span>Works Contract</span></label>
      </div>
      <div>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="EOU / STP / EHTP"> <span>EOU / STP / EHTP</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Import"> <span>Import</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Office / Sale Office"> <span>Office / Sale Office</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Warehouse / Depot"> <span>Warehouse / Depot</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Others"> <span>Others (Please Specify)</span></label>
      </div>
      <div>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Export"> <span>Export</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Supplier of Services"> <span>Supplier of Services</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Recipient of Goods or Services"> <span>Recipient of Goods or Services</span></label>
        <label class="activity-item"><input type="checkbox" name="business_activities" value="Wholesale Business"> <span>Wholesale Business</span></label>
      </div>
    </div>

    <div class="toggle-wrapper" style="margin-top:20px;">
      <div>Have Additional Place of Business</div>
      <div class="toggle"></div>
    </div>
  </div>

  <div class="btn-bar">
    <a href="{{ nav.rep }}" class="btn btn-secondary">BACK</a>
    <button type="submit" class="btn btn-green">SAVE & CONTINUE</button>
  </div>

</div>
</form>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script>
  // Initialize Leaflet map
  if(document.getElementById('map')) {
      var map = L.map('map').setView([23.5, 75.5], 7);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '¬© OpenStreetMap' }).addTo(map);
      var marker = L.marker([23.5, 75.5]).addTo(map);

      // Click to move marker
      map.on('click', function(e) {
        marker.setLatLng(e.latlng);
        var latField = document.getElementById('latField');
        var lngField = document.getElementById('lngField');
        if (latField) latField.value = e.latlng.lat.toFixed(6);
        if (lngField) lngField.value = e.latlng.lng.toFixed(6);
      });
  }
</script>
{% endblock %}